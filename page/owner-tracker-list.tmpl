{{ define "body" }}
  {{ template "header" }}
  <main class="mx-auto flex max-w-screen-lg flex-col justify-center gap-4 p-4">
    <a
      href="/create-tracker/"
      class="ml-auto flex items-center rounded-xl bg-eigengrau-700 px-3 py-1 text-sm text-white hover:bg-eigengrau-900"
    >
      {{ template "icon-plus" dict "class" "size-4" }}
      New Tracker
    </a>
    <ul
      id="trackers"
      class="grid grid-cols-[auto_auto_auto_auto_auto] place-content-center gap-x-4 divide-y"
    >
      <li
        class="group col-span-5 flex grid grid-cols-subgrid text-sm text-eigengrau-500"
      >
        <span> </span>
        <h1>Your Trackers</h1>
        <span> Past 7 days </span>
        <span> Today </span>
      </li>
      {{ range $ti, $t := .sessionUser.Trackers }}
        <li
          class="item group col-span-5 flex grid h-12 grid-cols-subgrid items-center"
        >
          <div
            class="invisible flex size-5 h-full cursor-move items-center group-hover:visible"
          >
            {{ template "icon-bars-3" dict "class" "handle size-5 text-eigengrau-500" }}
          </div>
          <h2 class="handle max-w-80 cursor-move font-semibold">
            {{ .DisplayName }}
          </h2>
          <div class="flex gap-1">
            {{ range $i, $d := slice (index $.daysArr $t.TrackerId ) 0 7 }}
              {{ template "day" dict "tracker" $t "day" $d }}
            {{ end }}
          </div>
          <div class="flex max-w-80 items-center gap-1">
            {{ $today := index (index $.daysArr $t.TrackerId ) 7 }}
            {{ template "day" dict "tracker" $t "day" $today }}
            {{ template "today-preview" dict "tracker" $t "day" $today }}
          </div>
          <div class="invisible flex items-center gap-1 group-hover:visible">
            <a href="/settings/{{ .TrackerId }}/">
              {{ template "icon-cog-6-tooth" dict "class" "size-5 text-eigengrau-500" }}
            </a>
            <a href="/{{ $.sessionUser.Username }}/{{ $t.TrackerId }}/">
              {{ template "icon-arrows-pointing-out" dict "class" "size-5 text-eigengrau-500" }}
            </a>
          </div>
        </li>
      {{ end }}
    </ul>
  </main>
  {{ template "day-detail-dialog" }}
  <script>
    const trackers = document.getElementById("trackers");
    const sortable = new Sortable(trackers, {
      handle: ".handle",
      touchStartThreshold: 8,
      animation: 150,
      draggable: ".item",
      onUpdate: function (event) {
        const body = new FormData();
        body.append("old_position", event.oldIndex);
        body.append("new_position", event.newIndex);
        fetch("/move-tracker/", {
          method: "PATCH",
          body: body,
        });
      },
    });
  </script>
{{ end }}
